<link rel="import" href="../lib-elements/flatiron-director.html">

<link rel="import" href="home/home.html">
<link rel="import" href="research/research.html">
<link rel="import" href="highlights/highlights.html">
<link rel="import" href="software/software.html">
<link rel="import" href="team/team.html">
<link rel="import" href="contact/contact.html">
<link rel="import" href="live/live.html">
<link rel="import" href="events/events.html">

<polymer-element name="container-element"  attributes="route scrollTopC">
  <template>
    <style>
      :host { :scope {display: block;} };
    </style>
<div>

<flatiron-director route="{{route}}" autoHash="false"></flatiron-director>

<template if="{{route != null}}">
  <template if="{{route == 'home-element' || route == ''}}">
    <home-element structure="{{home}}" scrool="{{scrollTopC}}"></home-element>
  </template>
  <template if="{{route == 'research-element'}}">
    <research-element structure="{{research}}" scrool="{{scrollTopC}}" cache="{{researchC}}"></research-element>
  </template>
  <template if="{{route == 'highlights-element'}}">
    <highlights-element structure="{{highlights}}" scrool="{{scrollTopC}}" cache="{{highlightsC}}"></highlights-element>
  </template>
  <template if="{{route == 'software-element'}}">
    <software-element structure="{{software}}" scrool="{{scrollTopC}}" cache="{{softwareC}}"></software-element>
  </template>
  <template if="{{route == 'team-element'}}">
    <team-element structure="{{team}}" scrool="{{scrollTopC}}" cache="{{teamC}}"></team-element>
  </template>
  <template if="{{route == 'contact-element'}}">
    <contact-element structure="{{contact}}" scrool="{{scrollTopC}}" cache="{{contactC}}"></contact-element>
  </template>
  <template if="{{route == 'live-element'}}">
    <live-element structure="{{live}}" scrool="{{scrollTopC}}" cache="{{liveC}}"></live-element>
  </template>
  <template if="{{route == 'events-element'}}">
    <events-element structure="{{events}}" scrool="{{scrollTopC}}"></events-element>
  </template>
</template>

</div>

  </template>
  <script>
    Polymer('container-element', {
      route: 'home-element',
      curPage: 0,
      prevPage: 0,
      ready: function() {
        // list the pages
        this.pages = [{id:'home-element', label:'home', index:0},
                     {id:'research-element', label:'research', index:1},
                     {id:'highlights-element', label:'highlights', index:2},
                     {id:'software-element', label:'software', index:3},
                     {id:'team-element', label:'team', index:4},
                     {id:'contact-element', label:'contact', index:5},
                     {id:'live-element', label:'live', index:6},
                     {id:'events-element', label:'events', index:7}];

                             // home page
        this.home = [{id:'welcome', label:'welcome',index:0}];

        // research page
        this.research = [{id:'challenges', label:'challenges', index:0},
                         {id:'mri', label:'mri', index:1},
                         {id:'nirs', label:'nirs', index:2},
                         {id:'meg', label:'meg', index:3}];

        // highlights a and awards page
        this.highlights = [{id:'ttfourteen', label:'2014', index:0},
                         {id:'ttthirteen', label:'2013', index:1},
                         {id:'tttwelve', label:'2012', index:2},
                         {id:'tteleven', label:'2011', index:3}];

        // software page
        this.software = [{id:'labbook', label:'ChRIS', index:0},
                         {id:'slicedrop', label:'Slice:Drop', index:1},
                         {id:'xtk', label:'XTK', index:2},
                         {id:'more', label:'More', index:3}];

        // team page
        this.team = [{id:'faculty', label:'faculty', index:0},
                     {id:'staff', label:'staff', index:1},
                     {id:'collaborators', label:'collaborators', index:2},
                     {id:'alumni', label:'alumni', index:3}];

        // contact page
        this.contact = [{id:'main', label:'main', index:0},
                        {id:'autumn', label:'autumn st', index:1},
                        {id:'waltham', label:'waltham', index:2}];

        // live page
        this.live = [{id:'live', label:'Live', index:0},
                     {id:'fnndsctalks', label:'FNNDSC Talks', index:1},
                     {id:'unix101', label:'Unix 101', index:2}];

        // live page
        this.events = [{id:'calendar', label:'calendar', index:0}];

      },
      refresh: function(){
        // select right element in the top nav
        this.navElts = this.parentElement.querySelectorAll('.nav-element');
      },
      updateNavigation: function(){
        if(this.curPage != this.prevPage && typeof(this.navElts) != 'undefined'){
          // && this.navElts
          // desactivate previous section
          this.navElts[this.prevPage].classList.remove('active');
          // // activate current section
          this.navElts[this.curPage].classList.add('active');
          // update variable
          this.prevPage = this.curPage;
        }
      },
      routeChanged: function() {
        // get index of current page
        // should be optimized
        var nbPages = this.pages.length;
        if(this.route == ''){
          this.curPage = 0;
        }
        else{
          for(var i=0; i<nbPages; i++){
            if(this.pages[i].id == this.route){
              this.curPage = i;
              break;
            }
          }
        }

        this.updateNavigation();
        }
    });
  </script>
</polymer-element>
